<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Data Workshop 2" href="data_workshop2.html"><link rel="prev" title="Linear Algebra 2" href="linear_algebra2.html">

    <link rel="shortcut icon" href="../_static/math-workshop-logo.png"><!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Statistics in Practice - SIO Math Workshop</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SIO Math Workshop</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">SIO Math Workshop</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Workshop Materials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedule</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../day1/index.html">Day 1</a><input aria-label="Toggle navigation of Day 1" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../day1/algebra.html">Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/geometry_trig.html">Units/Geometry/Trig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/complex_numbers.html">Complex Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/derivatives.html">Limits and Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/vector_calculus.html">Vector Calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/taylor_expansion.html">Taylor Expansions and Series Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/fourier_analysis.html">Fourier Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../day1/ode.html">Ordinary Differential Equations</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Day 2</a><input aria-label="Toggle navigation of Day 2" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro_to_stats.html">Intro to Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="distribution_functions.html">Distribution Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_workshop1.html">Data Workshop 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_algebra1.html">Linear Algebra 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_algebra2.html">Linear Algebra 2</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Statistics in Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_workshop2.html">Data Workshop 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_workshop2_pt2.html">Data Workshop 2 - Part 2</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/day2/stats_in_practice.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="Statistics-in-Practice">
<h1>Statistics in Practice<a class="headerlink" href="#Statistics-in-Practice" title="Link to this heading"></a></h1>
<p><strong>Helen Zhang</strong> (<a class="reference external" href="mailto:jiz053&#37;&#52;&#48;ucsd&#46;edu">jiz053<span>&#64;</span>ucsd<span>&#46;</span>edu</a>)</p>
<p>Contents:</p>
<ul class="simple">
<li><p>Rolling Dice - Review of random variables</p></li>
<li><p>Central Limit Theorum</p></li>
<li><p>Variance, Standard Deviation, Standard Error, Confidence intervals</p></li>
<li><p>Sea Surface Temperature vs. Sea Level</p>
<ul>
<li><p>Covariance</p></li>
<li><p>Correlation</p></li>
<li><p>Coherence</p></li>
</ul>
</li>
<li><p>SST over the years (not covered in class)</p></li>
</ul>
<section id="Random-Variables">
<h2>Random Variables<a class="headerlink" href="#Random-Variables" title="Link to this heading"></a></h2>
<p>Formal Definition:</p>
<p>Let <span class="math notranslate nohighlight">\(\Omega\)</span> be the set of all possible outcomes of some experiment and let <span class="math notranslate nohighlight">\(\omega \subset \Omega\)</span> be one specific outcome. We might not know anything about this population of outcomes or how likely each specific outcome may be, but we can conduct an experiment to pull out a particular outcome one at a time, which is called realization. This process of pulling out realizations is called a random variable, which is actually a function <span class="math notranslate nohighlight">\(X\)</span> that maps the set of all possible
outcomes <span class="math notranslate nohighlight">\(\Omega\)</span> to the collection of measured outcomes <span class="math notranslate nohighlight">\(O\)</span>.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[X: \Omega \to O\]</div>
</div>
<p>But nevermind the fancy formal math, let’s look at an example.</p>
<section id="Rolling-a-Die">
<h3>Rolling a Die<a class="headerlink" href="#Rolling-a-Die" title="Link to this heading"></a></h3>
<p>Consider a regular cubic die, the set of all outcomes is all the faces of the die <span class="math notranslate nohighlight">\(\Omega = [1, 2, 3, 4, 5, 6]\)</span>. Then the random variable <span class="math notranslate nohighlight">\(X\)</span> is a roll of the die.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">d6faces</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="c1">#Omega</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rollDie</span><span class="p">(</span><span class="n">faces</span><span class="p">):</span> <span class="c1">#Random Variable Function</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">faces</span><span class="p">)</span> <span class="c1">#realization</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Read em and weep boys! : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rollDie</span><span class="p">(</span><span class="n">d6faces</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Read em and weep boys! : 5
</pre></div></div>
</div>
<p>If we roll the die n times, we can create a bar plot showing the total number of times the die landed on each element <span class="math notranslate nohighlight">\(\omega\)</span> of the sample space <span class="math notranslate nohighlight">\(\Omega\)</span>. The bar plot, or histogram, describes the set of all observations <span class="math notranslate nohighlight">\(O\)</span> after it is rolled <span class="math notranslate nohighlight">\(n\)</span> number of times. This set of all observations are often called a sample.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">rollN</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">faces</span> <span class="o">=</span> <span class="n">d6faces</span><span class="p">):</span> <span class="c1">#get multiple random variables X</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">rollDie</span><span class="p">(</span><span class="n">faces</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>

<span class="n">binedges</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span>

<span class="c1">#Histograms!</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">bins</span> <span class="o">=</span> <span class="n">binedges</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span><span class="n">rwidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;5 Rolls&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="n">bins</span> <span class="o">=</span> <span class="n">binedges</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span><span class="n">rwidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">);</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;50 Rolls&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span><span class="n">bins</span> <span class="o">=</span> <span class="n">binedges</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span><span class="n">rwidth</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;500 Rolls&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">6.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.5, 6.5, 0.5, 6.5, 0.5, 6.5]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_3_1.png" src="../_images/day2_stats_in_practice_3_1.png" />
</div>
</div>
<p>If the die is fair, each face of the die would have an equal <span class="math notranslate nohighlight">\(\frac{1}{6}\)</span> chance of landing on top. Then the probability density should be constant.</p>
<p>But the histograms above do not really represent the probability distribution of <span class="math notranslate nohighlight">\(\Omega\)</span>, but rather the distribution of our sample <span class="math notranslate nohighlight">\(O\)</span>. The more rolls we make, the larger the sample size, and the more this histogram comes to resemble the actual constant distribution underlying <span class="math notranslate nohighlight">\(X\)</span>. To make our histograms look more like the nice functions we see in textbooks, we need to take the limit <span class="math notranslate nohighlight">\(N \to \infty\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the number of rolls.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100000</span> <span class="c1"># How many rolls?</span>

<span class="k">def</span><span class="w"> </span><span class="nf">calcDistr</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">minval</span><span class="p">,</span><span class="n">maxval</span><span class="p">,</span><span class="n">dbin</span><span class="p">):</span>
    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minval</span> <span class="o">-</span> <span class="n">dbin</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">maxval</span> <span class="o">+</span> <span class="n">dbin</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">((</span><span class="n">maxval</span> <span class="o">-</span> <span class="n">minval</span><span class="p">)</span><span class="o">/</span><span class="n">dbin</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="c1">#make bins</span>
    <span class="n">hist</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">hist</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span> <span class="c1">#normalize</span>
    <span class="n">cdf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">pdf</span><span class="p">[:</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="c1">#integrate</span>
    <span class="k">return</span> <span class="n">pdf</span><span class="p">,</span><span class="n">cdf</span><span class="p">,</span><span class="n">bins</span>

<span class="k">def</span><span class="w"> </span><span class="nf">midBins</span><span class="p">(</span><span class="n">bins</span><span class="p">):</span> <span class="c1">#find the middle of each bin</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>

<span class="n">pdf</span><span class="p">,</span><span class="n">cdf</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">calcDistr</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">midBins</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span><span class="n">pdf</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;PDF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">midBins</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span><span class="n">pdf</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span><span class="n">cdf</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CDF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span><span class="n">cdf</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PDF and CDF : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; rolls&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;PDF and CDF : 100000 rolls&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_5_1.png" src="../_images/day2_stats_in_practice_5_1.png" />
</div>
</div>
<p>Now this looks more like it!</p>
<p>Technically this is still not really a probability density <em>function</em>, since the faces can only be integer values. Rather, it is a discrete probability distribution. If we truly want to calculate a PDF we need make a die who could land on any real number between 0 and 6, or <span class="math notranslate nohighlight">\(\Omega = \{x \in \mathbb{R} | \ 0 \leq x \leq 6\}\)</span>, which would require the die to have an infinite number of faces.</p>
</section>
<section id="The-average-roll">
<h3>The average roll<a class="headerlink" href="#The-average-roll" title="Link to this heading"></a></h3>
<p>What is the average value of a die? Intuitively, we know that it’s probably somewhere between 3 and 4,even though that’s not a face on the die. To calculate this with math, we can multiply each face of the die <span class="math notranslate nohighlight">\(\omega \in \Omega\)</span> by the probability of it landing on top, and then adding everything together. Since the probability is <span class="math notranslate nohighlight">\(1/6\)</span> for every face, the average, or <em>expected value</em>, of a roll is,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E(X) = \frac{1 + 2 + 3 + 4 + 5 + 6}{6} = \frac{21}{6} = 3.5\]</div>
</div>
<p>Another way to find out the average value is by rolling the die many many times, and actually calculating the mean value across multiple rolls.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numrolls</span> <span class="o">=</span> <span class="mi">200000</span>
<span class="n">allrolls</span> <span class="o">=</span> <span class="n">rollN</span><span class="p">(</span><span class="n">numrolls</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rolls: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">allrolls</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean value of roll: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">allrolls</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Rolls: [4 1 4 ... 2 5 4]
Mean value of roll: 3.492995
</pre></div></div>
</div>
<p>Theoretically, the bigger our sample size (aka number of rolls), the closer we should get to the expected value of 3.5</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrolls</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">100000</span><span class="p">]</span>
<span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nrolls</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nrolls</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nrolls</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Average value of the die&#39;</span><span class="p">,</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Number of rolls&#39;</span><span class="p">,</span><span class="n">xscale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">);</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_9_0.png" src="../_images/day2_stats_in_practice_9_0.png" />
</div>
</div>
<p>In general, we can calculate the average value for a die with any number of faces. d12, d20, d413? It’s all possible, who cares about Euclid anyway. So for a dN where N is the number of faces, and the probability distribution across all faces is constant (so a fair die), the expected value of a roll is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E(X) = \frac{\sum_{k = 1}^n k}{n} = \frac{1}{n}\frac{n(n+1)}{2} = \frac{n+1}{2}\]</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_dnmeans</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Ns</span><span class="p">):</span>
    <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">#set up the faces for dN</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">faces</span> <span class="o">=</span> <span class="n">faces</span><span class="p">))</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">Ns</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ns</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">((</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Average roll of n-sided die&#39;</span><span class="p">)</span>
<span class="n">plot_dnmeans</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">6</span><span class="p">,</span><span class="n">nrolls</span><span class="p">)</span>
<span class="n">plot_dnmeans</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">12</span><span class="p">,</span><span class="n">nrolls</span><span class="p">)</span>
<span class="n">plot_dnmeans</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="mi">20</span><span class="p">,</span><span class="n">nrolls</span><span class="p">)</span>
<span class="n">plot_dnmeans</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">413</span><span class="p">,</span><span class="n">nrolls</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Number of rolls&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">xscale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_11_0.png" src="../_images/day2_stats_in_practice_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
204.3
</pre></div></div>
</div>
<p>The key takeaway here is that for any random variable <span class="math notranslate nohighlight">\(X\)</span>, the more realizations we have, the closer their distribution is to “reality”, and thus the closer their sample mean comes to its actual expected value. Here we used a die for our random variable <span class="math notranslate nohighlight">\(X\)</span> with a uniform distribution, but this is also true for any distribution of probabilities no matter how complicated.</p>
<p>As scientists, we are often making measurements to help us understand some complicated truth. If we are doing things right (ie. no systemic biases), then each measurement is a random variable and each data point a realization. The more data points we have, the distribution of the dataset becomes more “accurate”. Sample size matters!</p>
</section>
<section id="Rolling-multiple-dice">
<h3>Rolling multiple dice<a class="headerlink" href="#Rolling-multiple-dice" title="Link to this heading"></a></h3>
<p>Now say,instead of rolling just a single die, we roll a hundred dice all at once and take the average value of the lot. We already know that the expected value for a d6 is 3.5, but the sample means may fluctuate around that actual expected value. So each calculation for the sample mean is itself a random variable!</p>
<p>Question: <span class="math notranslate nohighlight">\(X : \Omega \to O\)</span>. What is <span class="math notranslate nohighlight">\(\Omega\)</span> now? What is <span class="math notranslate nohighlight">\(O\)</span>?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numrolls</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#how many rolls to average over?</span>
<span class="n">numexperiments</span> <span class="o">=</span> <span class="mi">15</span> <span class="c1">#how many times do we do the experiment?</span>

<span class="k">def</span><span class="w"> </span><span class="nf">avgRolls</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">rollN</span><span class="p">(</span><span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">means</span> <span class="o">=</span> <span class="n">avgRolls</span><span class="p">(</span><span class="n">numrolls</span><span class="p">,</span><span class="n">numexperiments</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean roll across &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numrolls</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; rolls, repeated &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numexperiments</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; times : </span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">means</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Mean roll across 5 rolls, repeated 15 times :
[3.2, 4.2, 2.2, 3.2, 4.4, 4.2, 3.6, 3.2, 3.2, 4.2, 4.0, 2.8, 2.4, 3.2, 3.2]
</pre></div></div>
</div>
<p>Let plot the distribution of these means. The shape may look familiar.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">histplotrolls</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">numrolls</span><span class="p">,</span><span class="n">numexp</span><span class="p">,</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">cdfax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">avgRolls</span><span class="p">(</span><span class="n">numrolls</span><span class="p">,</span><span class="n">numexp</span><span class="p">)</span>
    <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">100</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numrolls</span><span class="p">)))</span>
    <span class="n">bmid</span> <span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">bins</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">axhist</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bmid</span><span class="p">,(</span><span class="n">hist</span><span class="o">/</span><span class="n">hist</span><span class="o">.</span><span class="n">sum</span><span class="p">()),</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;# rolls: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numrolls</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; ; # exp: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numexp</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;; mean = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means</span><span class="p">),</span><span class="mi">3</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cdfax</span><span class="p">:</span>
        <span class="n">cdfax</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span><span class="o">/</span><span class="n">numexp</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">means</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">height_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">means15</span> <span class="o">=</span> <span class="n">histplotrolls</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="n">cdfax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">means150</span> <span class="o">=</span> <span class="n">histplotrolls</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1500</span><span class="p">,</span><span class="mi">1500</span><span class="p">,</span><span class="n">cdfax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.15</span><span class="p">],</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&quot;PDF&quot;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&quot;CDF&quot;&#39;</span><span class="p">,</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Mean over # rolls&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Probability of Averages&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;Probability of Averages&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_16_1.png" src="../_images/day2_stats_in_practice_16_1.png" />
</div>
</div>
<p>In the case where we calulate the mean roll over only 5 dice, we got a much larger range than when we did the same over 1500 dice (since we learned earlier that more dice <span class="math notranslate nohighlight">\(\to\)</span> more “accurate” the mean value). This is called the variance, or the <em>second moment</em>.</p>
</section>
<section id="Central-Limit-Theorem">
<h3>Central Limit Theorem<a class="headerlink" href="#Central-Limit-Theorem" title="Link to this heading"></a></h3>
<p>As we expect, the majority of the mean values are somewhere close to the true value 3.5, but there are outliers in either direction. But the more samples means we calculate, the more our probability distribution begin to resemble a very familiar shape. This distribution pops up so often that it is called the <em>normal distribution</em>.</p>
<p>The tendency for the a large enough sample of means to be normally distributed around the expected value is called the <em>central limit theorum</em>. In our case, we started with a uniform distribution (a fair die), but this property is always true! The sample means should be normally distributed around the actual expected value from that unknown underlying distribution, even if we don’t know what that is. This also means that if we take a number of samples from any distribution, we can get the
expected value by calculating the mean of the means.</p>
<p>Overall, the shape of this distribution is a gaussian, or a bell curve, which has the form</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[g(x) = \frac{1}{\sigma \sqrt{2\pi}} \exp\frac{-(x-\mu)^2}{2\sigma^2}\]</div>
</div>
<p><span class="math notranslate nohighlight">\(\mu\)</span> is the expected value, which sets the center of the curve, and <span class="math notranslate nohighlight">\(\sigma^2\)</span> is the variance, which sets the width. Since we saw earlier that the more rolls we have to calculate the mean, the closer that sample mean gets to the actual expected value 3.5, we should expect the variance from a greater number of rolls to be smaller. Indeed, we do see that the orange curve is narrower than the blue.</p>
<p>Caveat: Since these histograms are from discrete data, the probability “densities” aren’t really the same as a PDF. The purpose of these plots is to look at the <em>shape</em> of the distributions, and worry less about what the number on the yaxis. The CDF checks out though.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sig</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">sig</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">means15</span> <span class="o">=</span> <span class="n">histplotrolls</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="n">cdfax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">gaussian</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means15</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">means15</span><span class="p">)),</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">gaussian</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means15</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">means15</span><span class="p">)))</span><span class="o">*</span> <span class="p">(</span><span class="n">xbar</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">xbar</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Theory&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PDF&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;CDF&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">ylim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_19_0.png" src="../_images/day2_stats_in_practice_19_0.png" />
</div>
</div>
<section id="A-note-on-notation.">
<h4>A note on notation.<a class="headerlink" href="#A-note-on-notation." title="Link to this heading"></a></h4>
<p>In proper statistics, there is a distinction between the true <em>population</em> mean and the <em>sample</em> mean. When we use the above formula to calculate <span class="math notranslate nohighlight">\(E(X_{d413}) = 207\)</span> for the 413 sided die, that refers to the population mean <span class="math notranslate nohighlight">\(\mu\)</span>. Because 207 comes from an intrinsic property of the die, <span class="math notranslate nohighlight">\(\mu = 207\)</span> <em>always</em>. However, if we rolled the d413 ten times and get a sample mean of <span class="math notranslate nohighlight">\(\bar{x}\)</span> = 154.8, that might be different the next time we roll. Here are some common ways to
denote the means and variance (1st and 2nd moments).</p>
<ul class="simple">
<li><p>Mean:</p>
<ul>
<li><p>Population: <span class="math notranslate nohighlight">\(E(X)\)</span> or <span class="math notranslate nohighlight">\(\mu\)</span></p></li>
<li><p>Sample: <span class="math notranslate nohighlight">\(\bar{x}\)</span> or <span class="math notranslate nohighlight">\(\langle x \rangle\)</span></p></li>
</ul>
</li>
<li><p>Variance:</p>
<ul>
<li><p>Population: <span class="math notranslate nohighlight">\(\sigma^2\)</span> or <span class="math notranslate nohighlight">\(E((X - E(X))^2)\)</span></p></li>
<li><p>sample: <span class="math notranslate nohighlight">\(s^2\)</span></p></li>
</ul>
</li>
</ul>
<p>In oceanography we almost never know the actual <em>population</em> statistics, since that requires perfect knowledge of what we aim to measure before we even get there! Instead, we can only clumsily stick our probes into where we can, and as a result we are only working with <em>sample</em> statistics most of the time. The terminology may then become somewhat relaxed.</p>
</section>
</section>
</section>
<section id="Confidence-Intervals">
<h2>Confidence Intervals<a class="headerlink" href="#Confidence-Intervals" title="Link to this heading"></a></h2>
<p>Say now we have a weighted die, and we want to know the expected value of the die roll. Since it is no longer guaranteed that each side has an equal chance appearing on top, we can no longer assume that the expected value is 3.5 as it was before.</p>
<p>Let’s determine what it should be through the powers of experimentation. Using all the same steps as above, we can plot the distribution of the sample means by rolling the weighted die many times. And like before, we get something that looks normally distributed.</p>
<p>What is the expected value of the mystery die? If I guess that the expected value is 4.29 based on these plots, how confident should I be in that guess?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">57</span><span class="p">]</span> <span class="c1">#Choose any 6 numbers</span>
<span class="k">def</span><span class="w"> </span><span class="nf">weighted_roll</span><span class="p">(</span><span class="n">faces</span> <span class="o">=</span> <span class="n">d6faces</span><span class="p">,</span> <span class="n">wts</span> <span class="o">=</span> <span class="n">wts</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">faces</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wts</span><span class="p">)</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">wts</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">wtrollN</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">wts</span> <span class="o">=</span> <span class="n">wts</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">weighted_roll</span><span class="p">(</span><span class="n">wts</span> <span class="o">=</span> <span class="n">wts</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">avgwtRolls</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">wtrollN</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">wts</span> <span class="o">=</span> <span class="n">wts</span><span class="p">))</span><span class="o">/</span><span class="n">n</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Weighted die from 1000 experiments&#39;</span><span class="p">);</span>
<span class="n">wtmeans15</span> <span class="o">=</span> <span class="n">avgwtRolls</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;15 rolls, mean = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="mi">3</span><span class="p">)));</span>
<span class="n">wtmeans150</span> <span class="o">=</span> <span class="n">avgwtRolls</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">wtmeans150</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;150 rolls, mean = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans150</span><span class="p">),</span><span class="mi">3</span><span class="p">)));</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;upper left&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;Counts&#39;</span><span class="p">,</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Sample Mean&#39;</span><span class="p">,</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[Text(0, 0.5, &#39;Counts&#39;), Text(0.5, 0, &#39;Sample Mean&#39;), 1.0, 6.0]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_21_1.png" src="../_images/day2_stats_in_practice_21_1.png" />
</div>
</div>
<section id="Standard-deviation">
<h3>Standard deviation<a class="headerlink" href="#Standard-deviation" title="Link to this heading"></a></h3>
<p>Let’s say that the expected value is 4.29. But clearly, every time I re-run the code, the mean value from the plot is slightly different. So how can I know whether that was a good guess?. After running the block a bunch of times, however, I can observe that calculated means usualy land somewhere between 4 and 4.5, so I can be pretty confident the expected value is between those end points. How would we quantify this?</p>
<p>Previously in this review, we learned abut the variance. A standard deviation, like the variance, measure the variability of the data. It is equal to the square root of the variance.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sigma = \sqrt{\mathrm{var}(X)} = \sqrt{\frac{\Sigma_{i=0}^N (x_i - \mu)^2}{N}}\]</div>
</div>
<p>Often, the standard deviation is preferred over the variance because the variance is a squared quantity, so the standard deviation is more directly comparable to the values we are actively using. If our random variable had units, say [m/s] for wind speed, then the standard deviation would also have the same units.</p>
<p>By the central limit theorem, we know that this distribution is roughly normal. So let’s fit a gaussian to this data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">axtwin</span><span class="p">,</span><span class="n">xbar</span><span class="p">,</span><span class="n">arr</span><span class="p">,</span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">pdf</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">axtwin</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">nbins</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">pdf</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">wtmeans15</span> <span class="o">=</span> <span class="n">avgwtRolls</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">xbar</span><span class="p">,</span><span class="n">wtmeans15</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;15 rolls, 1000 exps: </span><span class="se">\n</span><span class="s1"> &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\mu$ = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; , &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sigma$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="mi">3</span><span class="p">)),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Sample mean&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_23_0.png" src="../_images/day2_stats_in_practice_23_0.png" />
</div>
</div>
<p>If we roll 15 weighted dice again for another sample mean, we can calculate how likely that next mean will land within some interval by integrating the gaussian inside that interval.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">in_interval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="n">inclusive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">inclusive</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span> <span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;=</span> <span class="nb">int</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="o">&gt;</span> <span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="nb">int</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">integrate_interval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
    <span class="n">interval</span> <span class="o">=</span> <span class="n">in_interval</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#needs to be constant</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">interval</span><span class="p">]</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Probability that the next sample mean is between 3-4: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">integrate_interval</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">pdf</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span><span class="mi">4</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;                     ...                         4-5: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">integrate_interval</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">pdf</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span><span class="mi">4</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The next sample mean: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtrollN</span><span class="p">(</span><span class="mi">15</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Probability that the next sample mean is between 3-4: 0.2312
                     ...                         4-5: 0.7345
The next sample mean: 4.2
</pre></div></div>
</div>
<p>Since we are using a gaussian distribution, there are a few special properties on which we can lean. First, if we center our interval at the mean, we can use just one number to describe the interval since the distribution is symmetrical. Second, we can use the standard deviation to specify these intervals with consistent probabilities. The probability that the value sits between <span class="math notranslate nohighlight">\(\mu \pm \sigma\)</span> is about 68%, while the probabiliy that it’s between <span class="math notranslate nohighlight">\(\mu \pm 2\sigma\)</span> is about 95%.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sig</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wtmeans15</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Within &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integrate_interval</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">pdf</span><span class="p">,[</span><span class="n">mu</span> <span class="o">-</span> <span class="n">sig</span><span class="p">,</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sig</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Within &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">integrate_interval</span><span class="p">(</span><span class="n">xbar</span><span class="p">,</span><span class="n">pdf</span><span class="p">,[</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">,</span><span class="n">mu</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sig</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Within 4.287+-0.391 = 68.21734054846854%
Within 4.287+-0.782 = 95.42690585676917%
</pre></div></div>
</div>
</section>
<section id="Standard-error">
<h3>Standard error<a class="headerlink" href="#Standard-error" title="Link to this heading"></a></h3>
<p>Let’s take a step back. The question I asked earlier wasn’t “How likely is the next sample mean going to be equal to <span class="math notranslate nohighlight">\(\mu\)</span>?”. It was “how likely is <span class="math notranslate nohighlight">\(\mu\)</span> the <em>actual expected value</em> of the mystery weighted die?</p>
<p>The distribution above already look like a bell curve. But the central limit theorem only promises us a normal distribution centered at the expected value if we take an <em>infinite</em> number of sample means. We’re not going to sit around and calculate dice rolls until the heat death of the universe, but we do know that the more experiments we do, the distribution looks more normal and the mean of that distribution is probably also closer to the expected value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[225]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wtmeans15_10</span> <span class="o">=</span> <span class="n">avgwtRolls</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">wtmeans15_10000</span> <span class="o">=</span> <span class="n">avgwtRolls</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">(),</span><span class="n">xbar</span><span class="p">,</span><span class="n">wtmeans15_10</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">(),</span><span class="n">xbar</span><span class="p">,</span><span class="n">wtmeans15_10000</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10 experiments&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;10000 experiments&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Means of 15 dice rolls&#39;</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[225]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;Means of 15 dice rolls&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_29_1.png" src="../_images/day2_stats_in_practice_29_1.png" />
</div>
</div>
<p>But the standard deviations of the two look almost the same! This makes sense since both are using 15 dice. They are both samples from the same normal distribution, it’s just that the second has more samples, so it represents the underlying normal distribution better, and the mean is probably more accurate. So how do we quantify that?</p>
<p>Behold the standard error.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[SE = \frac{\sigma}{\sqrt{n}}\]</div>
</div>
<p>Where <span class="math notranslate nohighlight">\(n\)</span> is the number of samples we have. The standard error, or sometimes called “standard error of the mean” is the key ingredient for how we actually define confidence intervals.</p>
<p>The confidence interval can than be calculated from the standard error and the mean</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C.I = \mu \pm Z * \frac{\sigma}{\sqrt{n}}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(Z\)</span> is a value that selects for how wide we want our confidence intervals to be. For <span class="math notranslate nohighlight">\(Z =1\)</span>, this translate to a confidence interval of about 68%, while <span class="math notranslate nohighlight">\(Z = 2\)</span> gives us something closer to 95%. These numbers come from distributions such as the Student’s t distribution, but are usually just kept in lookup tables <a class="reference external" href="https://www.sjsu.edu/faculty/gerstman/StatPrimer/t-table.pdf">this one</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[235]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;68</span><span class="si">% c</span><span class="s1">onfidence intervals: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> 10 experiments: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15_10</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;+-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wtmeans15_10</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wtmeans15_10</span><span class="p">)),</span><span class="mi">4</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> 10000 experiments: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wtmeans15_10000</span><span class="p">),</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;+-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wtmeans15_10000</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wtmeans15_10000</span><span class="p">)),</span><span class="mi">4</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
68% confidence intervals:
         10 experiments: 4.2333+-0.1415
         10000 experiments: 4.287+-0.004
</pre></div></div>
</div>
<p>And what is the actual expected value? Let’s calculate that from the weights we set earlier. The probability set by each weight is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[p(x_i) = \frac{wt_i}{\sum_{i=1}^6 wt_i}\]</div>
</div>
<p>and</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[E(X_{\mathrm{weighted\ die}}) = \sum_{i =1 }^6 p(x_i) * x_i\]</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[236]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pwts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">wts</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">wts</span><span class="p">)</span>
<span class="n">expval</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="n">d6faces</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">wts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]))</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">wts</span><span class="p">)</span>
<span class="n">expval</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[236]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4.292207792207792
</pre></div></div>
</div>
<p>So the guess of 4.29 is really not bad. Nice!</p>
</section>
</section>
<section id="Correlation,-covariance,-and-coherence">
<h2>Correlation, covariance, and coherence<a class="headerlink" href="#Correlation,-covariance,-and-coherence" title="Link to this heading"></a></h2>
<p>Sometimes, we have more than one sample, and we would like to compare them to each other. Three terms often come up in this context: correlation, covariance, and coherence. Let’s go through each of these with the SIO pier as our example.</p>
<p>The tide gauge data can be accessed via url. But I couldn’t find an equivalent for the temperature data. You may download the exact file I am using <a class="reference external" href="https://library.ucsd.edu/dc/object/bb4003017c">here</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#sort out data</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>

<span class="n">sst</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;LaJolla_TEMP_1916-202503.csv&#39;</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="mi">46</span><span class="p">)</span> <span class="c1">#SIO Pier Temp</span>
<span class="n">sst</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sst</span><span class="p">))]))</span>
<span class="n">ljtg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://uhslc.soest.hawaii.edu/data/csv/fast/daily/d554.csv&#39;</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;sl_mm&#39;</span><span class="p">])</span> <span class="c1"># SIO Pier Tide Gauge</span>
<span class="n">ljtg</span> <span class="o">=</span> <span class="n">ljtg</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="n">ljtg</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ljtg</span><span class="o">.</span><span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ljtg</span><span class="o">.</span><span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ljtg</span><span class="p">))]))</span>
<span class="c1">#match timestamps to make them the same length</span>
<span class="n">siotemp</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">SURF_TEMP_C</span><span class="p">[</span><span class="n">sst</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">ljtg</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">siosl</span> <span class="o">=</span> <span class="n">ljtg</span><span class="o">.</span><span class="n">sl_mm</span><span class="p">[</span><span class="n">ljtg</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">sst</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mi">1000</span> <span class="c1">#Remove fill values, convert from mm to m</span>
<span class="n">siosl</span><span class="p">[</span><span class="n">siosl</span><span class="o">&lt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">sst</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">sst</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">ljtg</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#plot the timeseries</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">siotemp</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature [deg C]&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span><span class="n">siosl</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">);</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Sea Level [m]&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;SIO Pier Temperature and Sea Level - Are they related? How?&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;SIO Pier Temperature and Sea Level - Are they related? How?&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_37_1.png" src="../_images/day2_stats_in_practice_37_1.png" />
</div>
</div>
<section id="Covariance-vs.-Correlation">
<h3>Covariance vs. Correlation<a class="headerlink" href="#Covariance-vs.-Correlation" title="Link to this heading"></a></h3>
<p>The two timeseries look like they “go together” pretty well. The simplest way to verify this is just to plot the two variables against each other as a scatter plot. Here, we see that there is a positive relationship between the two, which can be measured by the covariance.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIO Pier Temperature vs. Sea Level - Scatter plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">siotemp</span><span class="p">,</span><span class="n">siosl</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temp [deg C]&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39; SL [m]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39; SL [m]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_39_1.png" src="../_images/day2_stats_in_practice_39_1.png" />
</div>
</div>
<p>The covariance describes the <em>joint variability</em> between the two timeseries. We had the variance, and now we have two of them. The equation is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Cov(X,Y) = E((X - E(X))(Y-E(Y))) = \frac{\Sigma_{i=0}^N (X_i - \bar{X})(Y_i - \bar{Y})}{N}\]</div>
</div>
<p>Also, notice that this is very similar to the variance equation.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Var(X) = Cov(X,X)= \frac{\Sigma_{i=0}^N (X_i - \bar{X})^2}{N}\]</div>
</div>
<p>Note that the <span class="math notranslate nohighlight">\(N\)</span> in the denominator is for a <em>population</em> covariance, while the equation for <em>sample</em> covariances has <span class="math notranslate nohighlight">\(N-1\)</span> instead. But if our sample size <span class="math notranslate nohighlight">\(N\)</span> is big, this makes a very small difference. In python, we can calculate the covariance like this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_nans</span><span class="p">(</span><span class="n">arrs</span><span class="p">):</span>
    <span class="n">nans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">arrs</span><span class="p">:</span>
        <span class="n">nans</span> <span class="o">=</span> <span class="n">nans</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nans</span>
<span class="n">naninds</span> <span class="o">=</span> <span class="n">get_nans</span><span class="p">([</span><span class="n">siotemp</span><span class="p">,</span><span class="n">siosl</span><span class="p">])</span> <span class="c1">#[5144:8368]</span>

<span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">])</span> <span class="c1">#X1 - temperatures, X2- sea leveles</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[7.21158839, 0.14118371],
       [0.14118371, 0.00962333]])
</pre></div></div>
</div>
<p>This returns the covariance matrix where each element <span class="math notranslate nohighlight">\(C_{ij} = Cov(X_i,X_j)\)</span>. So <span class="math notranslate nohighlight">\(C_{00}\)</span> and <span class="math notranslate nohighlight">\(C_{11}\)</span> are, respectively, the variance of temperature and sea level. The covariance between the two are stored in the off diagonal elements <span class="math notranslate nohighlight">\(C_{10}\)</span> and $ C_{01}$ (which are the same).</p>
<p>So</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Cov(temp,sl) \approx 0.141\]</div>
</div>
<p align="center"><p><img alt="8ccc34aabf4f4e9f9a435b8434373182" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTcco21eXwuJry0TO87to5n61rW2Jc8TH3PIQ&amp;s" /></p>
<p><p>The covariance is positive, so we know that temperature is positively related to sea level. But how strong is this relationship? It is hard to intepret whether 0.141 is “close to zero”, as the infographic says. Furthermore, if I had input sea level in mm rather than m (like the raw data), then the covariance would be 1000x larger even if the information is identical.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[7.21158839e+00, 1.41183709e+02],
       [1.41183709e+02, 9.62332714e+03]])
</pre></div></div>
</div>
<p>Enter the correlation coefficient. This is the same thing as covariance, but now it is normalized by the variance of the input.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[Corr(X,Y) = r_{xy} = \frac{\Sigma_{i=0}^N (X_i - \bar{X})^2}{\sqrt{\Sigma(X_i - \bar{X})^2\Sigma(Y_i - \bar{Y})^2}} = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}\]</div>
</div>
<p>This will return a value between -1 and 1, which is independent of the variance of our inputs and can thus be compared to other correlation coefficients you encounter in the wild.</p>
<p>There is a built in function for this as well. Try multiplying either input by some constant. Does the correlation matrix change?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tempslcorr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tempslcorr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[1.         0.53592806]
 [0.53592806 1.        ]]
</pre></div></div>
</div>
<p>Note that the diagonals are now both 1, since anything is perfectly correrlated with itself. The information we seek is on the off diagonals. The <em>correlation coefficient</em> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[r_{xy} \approx 0.536\]</div>
</div>
<p>So the correlation is not super strong, but it certainly well above 0. If we plot a line on top of the scatter plot from earlier, this intepretation does make sense.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linfit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="o">~</span><span class="n">naninds</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIO Pier Temperature vs. Sea Level - Scatter plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">siotemp</span><span class="p">,</span><span class="n">siosl</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temps</span><span class="p">,</span><span class="n">temps</span><span class="o">*</span><span class="n">linfit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">linfit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Linear fit: sl = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">linfit</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; * temp + &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">linfit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;r = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tempslcorr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">transform</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temp [deg C]&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39; SL [m]&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x32ce8a4e0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_47_1.png" src="../_images/day2_stats_in_practice_47_1.png" />
</div>
</div>
</section>
<section id="Cross-Correlation">
<h3>Cross Correlation<a class="headerlink" href="#Cross-Correlation" title="Link to this heading"></a></h3>
<p>What if there is a time delay between temperature and sea level. For example, if I snap my fingers and make the entire ocean 2 degrees cooler, it might take some time between the moment I snapped my fingers to when the sea level actually begins to decrease. How would that impact things?</p>
<section id="Toy-Example">
<h4>Toy Example<a class="headerlink" href="#Toy-Example" title="Link to this heading"></a></h4>
<p>These two signals are identical, but one was shifted in time by some amount I thought was pretty. If I plot them against each other, the scatter plot doesn’t actually look linear!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">sig1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">sig2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mf">0.35</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sig1</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;signal 1&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;signal 2&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Two timeseries, one shifted over&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sig1</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;r = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">sig1</span><span class="p">,</span><span class="n">sig2</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">transform</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;signal 1&#39;</span><span class="p">,</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;signal 2&#39;</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Scatter plot&#39;</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_49_0.png" src="../_images/day2_stats_in_practice_49_0.png" />
</div>
</div>
<p>This is where the <em>cross correlation</em> comes in. It’s like the correlation coefficient, but now as a function of the time lag between the two inputs.</p>
<p>Let <span class="math notranslate nohighlight">\(X,Y\)</span> be distinct variables, and let <span class="math notranslate nohighlight">\(f,g\)</span> be their associated probability density functions. Then the cross correlation for a given lag (or displacement) <span class="math notranslate nohighlight">\(\tau\)</span> is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[XCorr(X,Y)(\tau) = (f \star g)(\tau) = \int_{-\infty}^\infty \overline{f(t)}g(t + \tau) dt = \int_{-\infty}^\infty \overline{f(t-\tau)}g(t) dt\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\overline{f(t)}\)</span> is the complex conjugate of f(t).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cross12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">sig1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sig1</span><span class="p">),</span><span class="n">sig2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sig2</span><span class="p">),</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="c1">#gotta normalize the inputs. The details of how are beyond the scope of this lecture</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">lags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cross12</span><span class="p">))</span><span class="o">-</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span> <span class="c1">#get my array of possible lags</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span><span class="n">cross12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag [$</span><span class="se">\\</span><span class="s1">tau$]&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross Correlation of Signal 2 and Signal 1&#39;</span><span class="p">)</span>
<span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">cross12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span><span class="n">cross12</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;max correlation, $</span><span class="se">\\</span><span class="s1">tau$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span><span class="mi">5</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max correlation: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">cross12</span><span class="p">[</span><span class="n">peak</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Max correlation: 0.9826849384722581
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_51_1.png" src="../_images/day2_stats_in_practice_51_1.png" />
</div>
</div>
<p>Here we have learned that the maximum correlation occurs when the first signal lags behind the second signal by 0.3. Even though we put in the same sine wave twice, some of this information got lost under the hood, so the nominal value of the correlation at this lag is only 0.98 instead of 1.0.</p>
</section>
<section id="Side-note:-Convolutions">
<h4>Side note: Convolutions<a class="headerlink" href="#Side-note:-Convolutions" title="Link to this heading"></a></h4>
<p>You might recognize the form of the integral used in the formula for cross correlation. This is called a convolution, and convoluted it sure is. Yet another word beginning with c that exists to confuse us all. A convolution is a type of operation that can be performed on any two functions. The cross correlation is a specific use case:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[(f(t) \star g(t)) (\tau) = (f(t) * g(-t))(\tau) = \int_{-\infty}^\infty \overline{f(t)}g(t - \tau) dt\]</div>
</div>
<p>Here’s an infographic.</p>
<p align="center"><p><img alt="9f0efeca03394ff2be6607a98493e115" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/Comparison_convolution_correlation.svg/800px-Comparison_convolution_correlation.svg.png" /></p>
<p><p>A full explaination of what this means is well beyond the scope of this lecture. But I do recommend this <a class="reference external" href="https://www.youtube.com/watch?v=KuXjwB4LzSA">youtube video</a>.</p>
</section>
<section id="Back-to-the-Ocean">
<h4>Back to the Ocean<a class="headerlink" href="#Back-to-the-Ocean" title="Link to this heading"></a></h4>
<p>How does this help us oceanographically? Well let’s apply this math to the two timeseries from above. Since we are integrating, we can’t have any NaNs in our arrays, so we need to zoom in to a part of the timeseries where there are no NaNs.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">naninds</span><span class="p">)[</span><span class="mi">150</span><span class="p">:</span><span class="mi">200</span><span class="p">]</span>
<span class="n">zoomin</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">5144</span><span class="p">,</span><span class="mi">8368</span><span class="p">)</span> <span class="c1">#trial and error :/</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">width_ratios</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;SIO Temp and SL, zoomed in&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">siotemp</span><span class="p">[</span><span class="n">zoomin</span><span class="p">]);</span><span class="n">ax2</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">();</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temp [deg C]&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">);</span><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SL [m]&#39;</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">([</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax2</span><span class="p">],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Timeseries&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;r = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">siosl</span><span class="p">[</span><span class="n">zoomin</span><span class="p">])[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="n">transform</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Temp [deg C]&#39;</span><span class="p">,</span><span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;SL [m]&#39;</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Scatter Plot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_53_0.png" src="../_images/day2_stats_in_practice_53_0.png" />
</div>
</div>
<p>Since we only care about the variability, and not the mean value, we need to subtract the mean temp and sea level from each timeseries. Then we normalize by the length of the vector.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">normalizearr</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">arr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tempnormed</span> <span class="o">=</span> <span class="n">normalizearr</span><span class="p">(</span><span class="n">siotemp</span><span class="p">[</span><span class="n">zoomin</span><span class="p">])</span>
<span class="n">slnormed</span> <span class="o">=</span> <span class="n">normalizearr</span><span class="p">(</span><span class="n">siosl</span><span class="p">[</span><span class="n">zoomin</span><span class="p">])</span>
<span class="n">crosstempsl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">tempnormed</span><span class="p">,</span><span class="n">slnormed</span><span class="p">,</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="c1">#gotta normalize the inputs. The details of how are beyond the scope of this lecture</span>
<span class="n">lags</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">crosstempsl</span><span class="p">))</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">zoomin</span><span class="p">]))</span> <span class="c1">#get my array of possible lags</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross Correlation - temp vs. sea level at SIO pier&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span><span class="n">crosstempsl</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]);</span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lags [days]&#39;</span><span class="p">)</span>
<span class="n">peak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">crosstempsl</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span><span class="n">crosstempsl</span><span class="p">[</span><span class="n">peak</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;lag = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">peak</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; days&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max correlation: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosstempsl</span><span class="p">[</span><span class="n">peak</span><span class="p">]))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Max correlation: 0.6380925226148204
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_56_1.png" src="../_images/day2_stats_in_practice_56_1.png" />
</div>
</div>
<p>So in the 1940s, the temperature timeseries lagged behind sea level timeseries by -48 days. In other words, tempeature <em>led</em> sea level by 48 days. Why would the sea level lag behind temperature for so long?</p>
<section id="Autocorrelation">
<h5>Autocorrelation<a class="headerlink" href="#Autocorrelation" title="Link to this heading"></a></h5>
<p>We could have also plugged in temperature for both <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> in our autocorrelation. What would that mean?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Auto Correlation - SIO Pier temp and SL&#39;</span><span class="p">)</span>
<span class="n">autoxtemps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">tempnormed</span><span class="p">,</span><span class="n">tempnormed</span><span class="p">,</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span><span class="n">autoxtemps</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxtemps</span><span class="p">)],</span><span class="n">autoxtemps</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxtemps</span><span class="p">)],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;lag = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxtemps</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="n">autoxsls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">correlate</span><span class="p">(</span><span class="n">slnormed</span><span class="p">,</span><span class="n">slnormed</span><span class="p">,</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lags</span><span class="p">,</span><span class="n">autoxsls</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxsls</span><span class="p">)],</span><span class="n">autoxsls</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxsls</span><span class="p">)],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;lag = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">lags</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">autoxsls</span><span class="p">)])</span> <span class="o">+</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">],</span><span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Lags [days]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_58_0.png" src="../_images/day2_stats_in_practice_58_0.png" />
</div>
</div>
</section>
</section>
</section>
<section id="Coherence">
<h3>Coherence<a class="headerlink" href="#Coherence" title="Link to this heading"></a></h3>
<p>We can see from above that the annual cycle dominates both the temperature and sea level signals. But what about other timescales? Do the two also correlate at daily timescales? Monthly?</p>
<p>This is where coherence comes in. Instead of giving the correlation as a function of time, it is now a function of <em>frequency</em>. Starting with the cross-correlation we calculate above, we take its Fourier transform to get a specturm of the cross-correlation, called a cross spectrum <span class="math notranslate nohighlight">\(G_{xy}\)</span>. Then the coherence is defined</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[C_{xy}(f) = \frac{|G_{xy}(f)|^2}{G_{xx}(f)G_{yy}(f)}\]</div>
</div>
<p><span class="math notranslate nohighlight">\(C_{xy}\)</span> is also called the squared-magnitude coherence. It is a real number that varies between 0 and 1 that speaks to how well the two signals cohere at a particular frequency. Furthermore, because the cross-spectrum is complex, we can also calculate form it the relative phase shift between the input signals. All in all, a very powerful tool!</p>
<p>To reduce noise and gain confidence in our calculations in the frequency domain, we use <a class="reference external" href="https://en.wikipedia.org/wiki/Welch%27s_method">Welch’s method</a> to segement the data into separate chunks, take the Fourier transform of each, and then average their results together.</p>
<p>I will assume that most people will encounter this method again in class, so I will not focus too much on the gritty details. Instead, my goal is to show what a coherence analysis could do, how it differs from the other terms discussed above, and how to intepret the results in an oceanographic context.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="n">f</span><span class="p">,</span><span class="n">cxy</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span><span class="n">tempnormed</span><span class="p">,</span><span class="n">slnormed</span><span class="p">,</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="mi">365</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">cxy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Coherence - Temp vs. Sea Level&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Coherence - Temp vs. Sea Level&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_60_1.png" src="../_images/day2_stats_in_practice_60_1.png" />
</div>
</div>
<p>Ok not much is happening… There’s the annual cycle, shown by the leftmost peak (more like a bump), and then not much else. This kind of analysis is limited by our dataset.</p>
<p>The highest frequency we can analyze is the Nyquist frequency = 0.5 * sampling rate. In this case, our sampling rate is daily, so we can only examine processes slower than once every two days. On the other extreme, we are limited by the resolution = 1/length of the timeseries. Since there are 8 years of data, so the resolution should be 1/8 years. However, because the data had to be segmented, we are actually bound by the length of each segment, which I had set to be 3 years. So we are also
limited to processes faster than once every three years. Still a wide range, just not very interesting for temperature vs. sea level.</p>
<p>Let’s look at some data with a higher sampling rate: La Jolla vs. San Francisco tide gauges.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ljtg2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://uhslc.soest.hawaii.edu/data/csv/fast/hourly/h554.csv&#39;</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span><span class="s1">&#39;sl_mm&#39;</span><span class="p">])</span> <span class="c1"># SIO Pier Tide Gauge</span>
<span class="n">ljtg2</span> <span class="o">=</span> <span class="n">ljtg2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">hour</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ljtg2</span><span class="p">))]))</span>
<span class="n">sftg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://uhslc.soest.hawaii.edu/data/csv/fast/hourly/h551.csv&#39;</span><span class="p">,</span><span class="n">header</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span><span class="s1">&#39;day&#39;</span><span class="p">,</span><span class="s1">&#39;hour&#39;</span><span class="p">,</span><span class="s1">&#39;sl_mm&#39;</span><span class="p">])</span> <span class="c1"># San Francisco</span>
<span class="n">sftg</span> <span class="o">=</span> <span class="n">sftg</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="n">sftg</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sftg</span><span class="o">.</span><span class="n">month</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sftg</span><span class="o">.</span><span class="n">day</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">sftg</span><span class="o">.</span><span class="n">hour</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sftg</span><span class="p">))]))</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ljssh</span> <span class="o">=</span> <span class="n">ljtg2</span><span class="o">.</span><span class="n">sl_mm</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">ljssh</span><span class="p">[</span><span class="n">ljssh</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">sfssh</span> <span class="o">=</span> <span class="n">sftg</span><span class="o">.</span><span class="n">sl_mm</span><span class="p">[</span><span class="n">sftg</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">ljtg2</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">sfssh</span><span class="p">[</span><span class="n">sfssh</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">zoomin</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">478676</span><span class="p">,</span><span class="mi">644320</span><span class="p">)</span> <span class="c1"># pick out the biggest chunk without NaNs</span>
<span class="n">ljsshnormed</span> <span class="o">=</span> <span class="n">normalizearr</span><span class="p">(</span><span class="n">ljssh</span><span class="p">[</span><span class="n">zoomin</span><span class="p">])</span>
<span class="n">sfsshnormed</span> <span class="o">=</span> <span class="n">normalizearr</span><span class="p">(</span><span class="n">sfssh</span><span class="p">[</span><span class="n">zoomin</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;La Jolla and San Francisco Sea Levels (normalized, de-meaned)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">ljsshnormed</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ljtg2</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">zoomin</span><span class="p">],</span><span class="n">sfsshnormed</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x32d059100&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_63_1.png" src="../_images/day2_stats_in_practice_63_1.png" />
</div>
</div>
<p>Lets put in some error bars to make sense of our results. Again, the focus is not on how these error bars are calulated, but rather how the results and interpretation should look.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#stuff to make the math work, treat as black box (for now)</span>
<span class="n">num_p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="mi">365</span><span class="o">*</span><span class="mi">24</span> <span class="c1">#number of data points per segment (yearly)</span>
<span class="n">gthresh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.05</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ljsshnormed</span><span class="p">)</span><span class="o">//</span><span class="n">num_p</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="c1">#error bar</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">cxy</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">coherence</span><span class="p">(</span><span class="n">ljsshnormed</span><span class="p">,</span><span class="n">sfsshnormed</span><span class="p">,</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span><span class="n">nperseg</span> <span class="o">=</span> <span class="n">num_p</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span><span class="n">pxy</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">csd</span><span class="p">(</span><span class="n">ljsshnormed</span><span class="p">,</span><span class="n">sfsshnormed</span><span class="p">,</span><span class="n">fs</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span><span class="n">nperseg</span> <span class="o">=</span> <span class="n">num_p</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">cxy</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Coherence - La Jolla vs. San Francisco&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">gthresh</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;95</span><span class="si">% c</span><span class="s1">onfidence threshhold&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogx</span><span class="p">()</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">pxy</span><span class="p">)</span>
<span class="n">ph</span><span class="p">[</span><span class="n">cxy</span> <span class="o">&lt;</span> <span class="n">gthresh</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span><span class="n">ph</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase&#39;</span><span class="p">)</span>
<span class="c1"># axs[1].scatter(freqs[310:450],ph[310:450],s = 1,color = &#39;r&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span><span class="n">xlim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[0.001, 10, 0.001, 10]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_65_1.png" src="../_images/day2_stats_in_practice_65_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Phase shift around f = 1/day: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="mi">310</span><span class="p">:</span><span class="mi">450</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">freqs</span><span class="p">[</span><span class="mi">310</span><span class="p">:</span><span class="mi">450</span><span class="p">])</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; hrs&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Phase shift around f = 2/day: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">ph</span><span class="p">[</span><span class="mi">650</span><span class="p">:</span><span class="mi">800</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">freqs</span><span class="p">[</span><span class="mi">650</span><span class="p">:</span><span class="mi">800</span><span class="p">])</span> <span class="o">*</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; hrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Phase shift around f = 1/day: -1.6428599589154422 hrs
Phase shift around f = 2/day: -1.0881826632831177 hrs
</pre></div></div>
</div>
<p>We can see that there is quite a lot of a noise in the data. But, despite the noise, there is clearly a wide peak around frequency = 1/day, as well as a few other one around 2/day. This makes sense since both San Francisco and San Diego experience the diurnal and semi-diurnal tides, among other near-daily cycles. The fact that the phase shift is negative here suggests that the sea level at La Jolla leads (is earlier than) that at San Francisco for these frequencies. By how much? If we only take
the phases close to 1/day, then the mean phase shift is about -0.4. So we need to mulitply the shift by the period.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[lag \ [hrs] = \frac{-0.4}{2\pi} * \frac{24\ hrs}{1\ day} \approx -1.5 \ hrs\]</div>
</div>
<p>The semi-diurnal sea level at La Jolla have a slightly shorter lead (<span class="math notranslate nohighlight">\(\approx 1 \ hrs\)</span>), even though the phase shift is greater because the period is only half as long.</p>
<section id="Non-stationary-statistics?">
<h4>Non-stationary statistics?<a class="headerlink" href="#Non-stationary-statistics?" title="Link to this heading"></a></h4>
<p>An important caveat for most of these methods: correlation, coherence, etc. is that they assume that the signal’s statistics remain constant throughout the whole timeseries. But this is not always accurate. Many meteorological variables are highly non-linear. Think of a location with a nice calm summer versus a stormy winter. The mean and variance of the wind timeseries would then have an annual cycle.</p>
<p>It is possible to adapt all of the above methods into a time variable description using methods like a running mean, running variance, and <a class="reference external" href="https://paos.colorado.edu/research/wavelets/bams_79_01_0061.pdf">wavelet analysis</a>. Check these out if the stationary methods aren’t working well for your dataset.</p>
<p>*** END OF IN CLASS MATERIAL (2025) ***</p>
</section>
</section>
</section>
<section id="Testing-samples-against-each-other---SIO-Pier-SST">
<h2>Testing samples against each other - SIO Pier SST<a class="headerlink" href="#Testing-samples-against-each-other---SIO-Pier-SST" title="Link to this heading"></a></h2>
<p>Ok let’s back away slowly from the esoteric frequency space analysis for now. In our earlier dice example, the distinction between some of our terms might be more subtle because the random variables that we were dealing with are themselves a mean, and it’s not immediately obvious which mean we even, well, mean…</p>
<p>Let’s look at something else. Here is the SST (sea surface temperature) from the Scripps pier again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]);</span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[deg C]&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SIO Pier Sea Surface Temperature [SST]&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;SIO Pier Sea Surface Temperature [SST]&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_69_1.png" src="../_images/day2_stats_in_practice_69_1.png" />
</div>
</div>
<p>What is the expected value of SST in January across all time?</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[161]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rm_nans</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">arr</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">arr</span><span class="p">)]</span>
<span class="n">ssts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]),</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># What is the average January temperature?</span>
<span class="n">jans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">jansst</span> <span class="o">=</span> <span class="n">rm_nans</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">jans</span><span class="p">][</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ssts</span><span class="p">,</span><span class="n">jansst</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mu$ = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jansst</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; , &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sigma$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">jansst</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span>  <span class="s1">&#39;, N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jansst</span><span class="p">)),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;January SST distribution&#39;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;SST [deg C]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_71_0.png" src="../_images/day2_stats_in_practice_71_0.png" />
</div>
</div>
<p>So the sample mean January SST between 1916 - 2025 is about 14.43 deg C. The standard error tells us how close this mean is to the “correct” value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[231]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;We can be 95</span><span class="si">% c</span><span class="s1">onfident that the expected SST of January is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jansst</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;+-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">jansst</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jansst</span><span class="p">)),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; deg C, brrr!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
We can be 95% confident that the expected SST of January is 14.43+-0.04 deg C, brrr!
</pre></div></div>
</div>
<section id="Did-the-expected-value-of-January-temperature-use-to-be-different?---One-Sample-Student's-t-test">
<h3>Did the expected value of January temperature use to be different? - One Sample Student’s t-test<a class="headerlink" href="#Did-the-expected-value-of-January-temperature-use-to-be-different?---One-Sample-Student's-t-test" title="Link to this heading"></a></h3>
<p>The plot suggests that the SST has changed over time. If we look at the distributions of January SSTs in 1917, the first winter of data. Do they have the same mean as the overall mean?</p>
<p>This is the kind of the question that can be answered with the one sample Student’s t-test, which is a statistic that measures how well a particular sample’s mean and spread compares to a hypothetical mean. The t-value can be calculated</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[t = \frac{\bar{x} - \mu_0}{SE}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\bar{x}\)</span> is the sample mean and <span class="math notranslate nohighlight">\(\mu_0\)</span> is the postulate mean. Fun history fact, it’s called Student’s t-test not because it’s for students to learn, but rather that it is named after William Sealy Gosset, who published the original paper on this topic under the pseudonym “Student” (this is why Student is capitalized!). Gosset worked for the Guiness brewing company at the time, and he came up with this metric in order to quality control small batches of ingredients.</p>
<p>Anyway, we’re not talking about beer. We’re talking about the ocean. let’s test our 1917 January sample against a population mean of 14.4 deg C.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jan1917</span> <span class="o">=</span> <span class="n">rm_nans</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1917</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()][</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ssts</span><span class="p">,</span><span class="n">jan1917</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mu$ = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jan1917</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; , &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sigma$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">jan1917</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, n = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jan1917</span><span class="p">)),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;January 1917 SST distribution&#39;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;SST [deg C]&#39;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_75_0.png" src="../_images/day2_stats_in_practice_75_0.png" />
</div>
</div>
<p>First we need to know the degree of freedom. For this test,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[DoF = n-1\]</div>
</div>
<p>We then use the degree of freedom and desired amount of confidence to look up the maximum number the t-value could be in order to accept or reject <span class="math notranslate nohighlight">\(\mu_0\)</span> as the mean.</p>
<p>Usually we can use a lookup table or built in function to determine this maximum value. It comes from a <a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-distribution">complicated PDF</a> suitably called the “Student’s t distribution”. But let’s just use the python package function <code class="docutils literal notranslate"><span class="pre">scipy.stats.ttest_1samp</span></code> instead. It gives us a p-value for whether we can reject the null hypothesis (which is that the mean is equal to 14.4 deg C). Other coding languages will also most likely have a built in
function for this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;1917 January mean SST: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jan1917</span><span class="p">)))</span>
<span class="n">sc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">jan1917</span><span class="p">,</span><span class="n">popmean</span> <span class="o">=</span> <span class="mf">14.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1917 January mean SST: 11.828
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TtestResult(statistic=-44.65564924672246, pvalue=1.2967666308174706e-24, df=24)
</pre></div></div>
</div>
<p>The null hypothesis of the test is that the mean is 14.4 deg C. Let’s say we want to be 99% sure. Looking at the p-value, it is <em>well</em> below 0.01, meaning that we can <em>reject</em> the null hypothesis. So the January mean SST in the 1917 is most likely NOT from a distribution that has a mean of 14.4 deg C. The p-value is negative, so we can be 99% sure that it was colder back then.</p>
</section>
<section id="How-much-and-when-did-the-mean-change?---Two-sample-Student's-t-test">
<h3>How much and when did the mean change? - Two sample Student’s t-test<a class="headerlink" href="#How-much-and-when-did-the-mean-change?---Two-sample-Student's-t-test" title="Link to this heading"></a></h3>
<p>Before, we wanted to know whether the mean of one sample is equal to some specific value. Now, let’s find out whether the means of two samples are the same. So let’s compare Januaries in the 1920s to the 2010s and ask whether they are the same. We can do this with a 2 sample Student’s t-test.</p>
<p>We need to make a few assumptions: 1. The samples are plausibly normally distributed, 2. The two samples have roughly the same standard deviation, and most importantly 3. The samples are independent. As we saw before, January temperatures look approximately normally distributed, given enough days. And each January is independent from the previous one. It’s not clear whether the standard deviations are the same.</p>
<p>The t-value here is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[t = \frac{\bar{x}_1 - \bar{x}_2}{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[s_p = \sqrt{\frac{(n_1 - 1)\sigma_1 + (n_2 - 1)\sigma_2}{n_1 + n_2 -2 }}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\bar{x}_1\)</span>,<span class="math notranslate nohighlight">\(\bar{x}_2\)</span> are the mean values in each sample, <span class="math notranslate nohighlight">\(\sigma_1\)</span>,<span class="math notranslate nohighlight">\(\sigma_2\)</span> are the standard deviations, and <span class="math notranslate nohighlight">\(n_1\)</span>,<span class="math notranslate nohighlight">\(n_2\)</span> are the sample sizes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[238]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jan1920s</span> <span class="o">=</span> <span class="n">rm_nans</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">in_interval</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">],[</span><span class="mi">1920</span><span class="p">,</span><span class="mi">1929</span><span class="p">]))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()][</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">jan2010s</span> <span class="o">=</span> <span class="n">rm_nans</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">in_interval</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">],[</span><span class="mi">2010</span><span class="p">,</span><span class="mi">2019</span><span class="p">]))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()][</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ssts</span><span class="p">,</span><span class="n">jan1920s</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;1920s: $\mu$ = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jan1920s</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; , &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sigma$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">jan1920s</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, n = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jan1920s</span><span class="p">)),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plot_histgauss</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ssts</span><span class="p">,</span><span class="n">jan2010s</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;2010s: $\mu$ = &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jan2010s</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39; , &#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\sigma$ = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">jan2010s</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, n = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jan2010s</span><span class="p">)),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;January SST distribution&#39;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;SST [deg C]&#39;</span><span class="p">);</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_79_0.png" src="../_images/day2_stats_in_practice_79_0.png" />
</div>
</div>
<p>The standard deviation is a little bit bigger in the 2010s, but let’s say that they are close enough for this test. Let’s use a pre-made function again, <code class="docutils literal notranslate"><span class="pre">scipy.stats.ttest_ind</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">jan1920s</span><span class="p">,</span><span class="n">jan2010s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TtestResult(statistic=-17.25535507998279, pvalue=4.4983852755735795e-54, df=575.0)
</pre></div></div>
</div>
<p>The p-value is the probability of the two samples come from the tail ends of the same distribution. So it it’ss incredibly unlikely, and the two means are very different.</p>
<p>Technically, our variances were not the same, so instead we can also use a version of the t-test that relaxes this assumption called the Welch’s test. It gives the same statistic, but now the p-value is an order of magnitude bigger. Nowhere close to making us think that the two means are the same though!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[239]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">jan1920s</span><span class="p">,</span><span class="n">jan2010s</span><span class="p">,</span><span class="n">equal_var</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TtestResult(statistic=-17.216466796112798, pvalue=1.3673500416202044e-53, df=557.8551171602098)
</pre></div></div>
</div>
<p>Now what if I want to quantify how much each January differ from the statistics of the whole population over time. For each year, let’s calculate how the statistics change.</p>
<p>Because we have a p-value, we can also get a sense of how relevant each statistic is. If a year is close to the mean, we can show that. In this case, I chose to scale the size of the scatter point by the p-value. The smaller the p-value, the larger the size of the scatter point. The distributions and scatter points are also colored by year. The darker the color = more recent.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cmocean.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cmo</span>
<span class="n">years</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1917</span><span class="p">,</span><span class="mi">2020</span><span class="p">)</span>
<span class="n">alljans</span> <span class="o">=</span> <span class="p">[</span><span class="n">rm_nans</span><span class="p">(</span><span class="n">sst</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">((</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">sst</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">yr</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()][</span><span class="s1">&#39;SURF_TEMP_C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">yr</span> <span class="ow">in</span> <span class="n">years</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">cmo</span><span class="o">.</span><span class="n">amp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">alljans</span><span class="p">)))</span>
<span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">();</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">]);</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;SSTs [deg C]&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Prob. Density&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distribution&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alljans</span><span class="p">)):</span>
    <span class="n">plot_histgauss</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ax1</span><span class="p">,</span><span class="n">ssts</span><span class="p">,</span><span class="n">alljans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">years</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">tvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">sc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">jansst</span><span class="p">,</span><span class="n">alljans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">equal_var</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">statistic</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">))]</span>
<span class="n">pvals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="o">*</span><span class="n">sc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">jansst</span><span class="p">,</span><span class="n">alljans</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">equal_var</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">years</span><span class="p">))]</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">years</span><span class="p">,</span><span class="n">tvals</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span><span class="n">s</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pvals</span><span class="p">))))</span>
<span class="n">linfit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">years</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tvals</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">linfit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">years</span> <span class="o">+</span> <span class="n">linfit</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;slope = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">linfit</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t statistic&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Years&#39;</span><span class="p">);</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mean SST of all Januaries compared to the mean Janary SST of a particular given year&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;All Jan SSTs by year&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/day2_stats_in_practice_85_0.png" src="../_images/day2_stats_in_practice_85_0.png" />
</div>
</div>
<p>So yeah… Things definitely did change over time compared to the overall statistic. Since the 1970s, the mean January SST over all time is much lower than the mean January SST for that year. How very curious…</p>
<p>There is also a lot of interannual variabilities, some of which seem almost regular. That’s interesting. Why do you think that is?</p>
<p>Hint: check out things like the ENSO index, PDO, etc.</p>
</section>
<section id="Other-tests">
<h3>Other tests<a class="headerlink" href="#Other-tests" title="Link to this heading"></a></h3>
<p>Anyway, there’s a lot more statistical tests out there in a similar vein. The details are beyond the scope of this lecture (note), mostly because it’s getting past 2am and I’m tired. But hey, if you’re running this notebook in Jupyter, you can keep playing around with this data.</p>
<p>Two common ones you might encounter are the KS (Kolmogorov–Smirnov) test, and the Chi-squared test. Both of which are based on the same foundations we explored today (expected values, PDFs, standard deviations etc.), but they aren’t just comparing the means, but rather the whole distribution. For example, if you were skeptical that the distribution of January SST was indeed normal, you can use one of these to find out. I actually shopped around the decades in that pier dataset to find ones that
looked more normal. Some decades are funky, in particular ones where there were strong El Ninos (like the 1990s). So you could try to quantify that!</p>
<p>The KS test asks if your distribution is the same as some theoretical <em>continuous</em> distribution. While the <span class="math notranslate nohighlight">\(\chi^2\)</span> test is similar, but for discrete or binned data. Both of them are also probably built into whatever programming thing you’re using.</p>
<p>Happy analyzing!</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="data_workshop2.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Data Workshop 2</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="linear_algebra2.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Linear Algebra 2</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Tommy Stone
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Statistics in Practice</a><ul>
<li><a class="reference internal" href="#Random-Variables">Random Variables</a><ul>
<li><a class="reference internal" href="#Rolling-a-Die">Rolling a Die</a></li>
<li><a class="reference internal" href="#The-average-roll">The average roll</a></li>
<li><a class="reference internal" href="#Rolling-multiple-dice">Rolling multiple dice</a></li>
<li><a class="reference internal" href="#Central-Limit-Theorem">Central Limit Theorem</a><ul>
<li><a class="reference internal" href="#A-note-on-notation.">A note on notation.</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Confidence-Intervals">Confidence Intervals</a><ul>
<li><a class="reference internal" href="#Standard-deviation">Standard deviation</a></li>
<li><a class="reference internal" href="#Standard-error">Standard error</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Correlation,-covariance,-and-coherence">Correlation, covariance, and coherence</a><ul>
<li><a class="reference internal" href="#Covariance-vs.-Correlation">Covariance vs. Correlation</a></li>
<li><a class="reference internal" href="#Cross-Correlation">Cross Correlation</a><ul>
<li><a class="reference internal" href="#Toy-Example">Toy Example</a></li>
<li><a class="reference internal" href="#Side-note:-Convolutions">Side note: Convolutions</a></li>
<li><a class="reference internal" href="#Back-to-the-Ocean">Back to the Ocean</a><ul>
<li><a class="reference internal" href="#Autocorrelation">Autocorrelation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Coherence">Coherence</a><ul>
<li><a class="reference internal" href="#Non-stationary-statistics?">Non-stationary statistics?</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Testing-samples-against-each-other---SIO-Pier-SST">Testing samples against each other - SIO Pier SST</a><ul>
<li><a class="reference internal" href="#Did-the-expected-value-of-January-temperature-use-to-be-different?---One-Sample-Student's-t-test">Did the expected value of January temperature use to be different? - One Sample Student’s t-test</a></li>
<li><a class="reference internal" href="#How-much-and-when-did-the-mean-change?---Two-sample-Student's-t-test">How much and when did the mean change? - Two sample Student’s t-test</a></li>
<li><a class="reference internal" href="#Other-tests">Other tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>